[mirai-core](../../index.md) / [net.mamoe.mirai](../index.md) / [BotImpl](./index.md)

# BotImpl

`abstract class BotImpl<N : BotNetworkHandler> : `[`Bot`](../-bot/index.md)`, CoroutineScope`

### Constructors

| [&lt;init&gt;](-init-.md) | `BotImpl(context: `[`Context`](../../net.mamoe.mirai.utils/-context/index.md)`, configuration: `[`BotConfiguration`](../../net.mamoe.mirai.utils/-bot-configuration/index.md)`)` |

### Properties

| [configuration](configuration.md) | `val configuration: `[`BotConfiguration`](../../net.mamoe.mirai.utils/-bot-configuration/index.md) |
| [context](context.md) | [Bot](../-bot/index.md) 运行的 [Context](../../net.mamoe.mirai.utils/-context/index.md).`open val context: `[`Context`](../../net.mamoe.mirai.utils/-context/index.md) |
| [coroutineContext](coroutine-context.md) | `val coroutineContext: `[`CoroutineContext`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.coroutines/-coroutine-context/index.html) |
| [logger](logger.md) | 日志记录器`val logger: `[`MiraiLogger`](../../net.mamoe.mirai.utils/-mirai-logger/index.md) |
| [network](network.md) | 网络模块. 此为内部 API: 它可能在任意时刻被改动.`val network: N` |
| [uin](uin.md) | `open val ~~uin~~: `[`Long`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-long/index.html) |

### Functions

| [close](close.md) | 关闭这个 [Bot](../-bot/index.md), 立即取消 [Bot](../-bot/index.md) 的 [kotlinx.coroutines.SupervisorJob](#). 之后 [kotlinx.coroutines.isActive](#) 将会返回 `false`.`open fun close(cause: `[`Throwable`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-throwable/index.html)`?): `[`Unit`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-unit/index.html) |
| [createNetworkHandler](create-network-handler.md) | `abstract fun createNetworkHandler(coroutineContext: `[`CoroutineContext`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.coroutines/-coroutine-context/index.html)`): N` |
| [login](login.md) | **Exposed public API** [BotImpl.relogin](relogin.md) && [BotNetworkHandler.init](#)`suspend fun login(): `[`Unit`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-unit/index.html) |
| [relogin](relogin.md) | Close server connection, resend login packet, BUT DOESN'T [BotNetworkHandler.init](#)`abstract suspend fun relogin(cause: `[`Throwable`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-throwable/index.html)`?): `[`Unit`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-unit/index.html) |

### Companion Object Functions

| [forEachInstance](for-each-instance.md) | `fun forEachInstance(block: (`[`Bot`](../-bot/index.md)`) -> `[`Unit`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-unit/index.html)`): `[`Unit`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-unit/index.html) |
| [getInstance](get-instance.md) | `fun getInstance(qq: `[`Long`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-long/index.html)`): `[`Bot`](../-bot/index.md) |

### Extension Functions

| [alsoLogin](../also-login.md) | 登录, 返回 [this](../also-login/-this-.md)`suspend fun <B : `[`Bot`](../-bot/index.md)`> B.alsoLogin(): B` |
| [buildMessageSource](../../net.mamoe.mirai.message.data/build-message-source.md) | 构建一个 [OfflineMessageSource](../../net.mamoe.mirai.message.data/-offline-message-source/index.md)`fun `[`Bot`](../-bot/index.md)`.buildMessageSource(block: `[`MessageSourceBuilder`](../../net.mamoe.mirai.message.data/-message-source-builder/index.md)`.() -> `[`Unit`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-unit/index.html)`): `[`MessageSource`](../../net.mamoe.mirai.message.data/-message-source/index.md) |
| [closeAndJoin](../close-and-join.md) | 关闭这个 [Bot](../-bot/index.md), 停止一切相关活动. 所有引用都会被释放.`suspend fun `[`Bot`](../-bot/index.md)`.closeAndJoin(cause: `[`Throwable`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-throwable/index.html)`? = null): `[`Unit`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-unit/index.html) |
| [containsFriend](../contains-friend.md) | `fun `[`Bot`](../-bot/index.md)`.containsFriend(id: `[`Long`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-long/index.html)`): `[`Boolean`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-boolean/index.html) |
| [containsGroup](../contains-group.md) | `fun `[`Bot`](../-bot/index.md)`.containsGroup(id: `[`Long`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-long/index.html)`): `[`Boolean`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-boolean/index.html) |
| [getFriendOrNull](../get-friend-or-null.md) | `fun `[`Bot`](../-bot/index.md)`.getFriendOrNull(id: `[`Long`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-long/index.html)`): `[`Friend`](../../net.mamoe.mirai.contact/-friend/index.md)`?` |
| [getGroupOrNull](../get-group-or-null.md) | `fun `[`Bot`](../-bot/index.md)`.getGroupOrNull(id: `[`Long`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-long/index.html)`): `[`Group`](../../net.mamoe.mirai.contact/-group/index.md)`?` |
| [join](../join.md) | 挂起协程直到 [Bot](../-bot/index.md) 下线.`suspend fun `[`Bot`](../-bot/index.md)`.join(): `[`Unit`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-unit/index.html) |
| [recall](../recall.md) | 撤回这条消息.`suspend fun `[`Bot`](../-bot/index.md)`.recall(message: `[`MessageChain`](../../net.mamoe.mirai.message.data/-message-chain/index.md)`): `[`Unit`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-unit/index.html) |
| [recallIn](../recall-in.md) | 在一段时间后撤回这个消息源所指代的消息.`fun `[`Bot`](../-bot/index.md)`.recallIn(source: `[`MessageSource`](../../net.mamoe.mirai.message.data/-message-source/index.md)`, millis: `[`Long`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-long/index.html)`, coroutineContext: `[`CoroutineContext`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.coroutines/-coroutine-context/index.html)` = EmptyCoroutineContext): Job`<br>在一段时间后撤回这条消息.`fun `[`Bot`](../-bot/index.md)`.recallIn(message: `[`MessageChain`](../../net.mamoe.mirai.message.data/-message-chain/index.md)`, millis: `[`Long`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-long/index.html)`, coroutineContext: `[`CoroutineContext`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.coroutines/-coroutine-context/index.html)` = EmptyCoroutineContext): Job` |
| [subscribe](../../net.mamoe.mirai.event/subscribe.md) | 在 [Bot](../-bot/index.md) 的 [CoroutineScope](#) 下订阅所有 [E](../../net.mamoe.mirai.event/subscribe.md#E) 及其子类事件. 每当 [事件广播](../../net.mamoe.mirai.event/broadcast.md) 时, [handler](../../net.mamoe.mirai.event/subscribe.md#net.mamoe.mirai.event$subscribe(net.mamoe.mirai.Bot, kotlin.coroutines.CoroutineContext, net.mamoe.mirai.event.Listener.ConcurrencyKind, kotlin.coroutines.SuspendFunction2((net.mamoe.mirai.event.subscribe.E, , net.mamoe.mirai.event.ListeningStatus)))/handler) 都会被执行, 当 [handler](../../net.mamoe.mirai.event/subscribe.md#net.mamoe.mirai.event$subscribe(net.mamoe.mirai.Bot, kotlin.coroutines.CoroutineContext, net.mamoe.mirai.event.Listener.ConcurrencyKind, kotlin.coroutines.SuspendFunction2((net.mamoe.mirai.event.subscribe.E, , net.mamoe.mirai.event.ListeningStatus)))/handler) 返回 [ListeningStatus.STOPPED](../../net.mamoe.mirai.event/-listening-status/-s-t-o-p-p-e-d.md) 时停止监听`fun <E : `[`BotEvent`](../../net.mamoe.mirai.event.events/-bot-event/index.md)`> `[`Bot`](../-bot/index.md)`.subscribe(coroutineContext: `[`CoroutineContext`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.coroutines/-coroutine-context/index.html)` = EmptyCoroutineContext, concurrency: ConcurrencyKind = Listener.ConcurrencyKind.LOCKED, handler: suspend E.(E) -> `[`ListeningStatus`](../../net.mamoe.mirai.event/-listening-status/index.md)`): `[`Listener`](../../net.mamoe.mirai.event/-listener/index.md)`<E>``fun <E : `[`BotEvent`](../../net.mamoe.mirai.event.events/-bot-event/index.md)`> `[`Bot`](../-bot/index.md)`.subscribe(eventClass: `[`KClass`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.reflect/-k-class/index.html)`<E>, coroutineContext: `[`CoroutineContext`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.coroutines/-coroutine-context/index.html)` = EmptyCoroutineContext, concurrency: ConcurrencyKind = Listener.ConcurrencyKind.LOCKED, handler: suspend E.(E) -> `[`ListeningStatus`](../../net.mamoe.mirai.event/-listening-status/index.md)`): `[`Listener`](../../net.mamoe.mirai.event/-listener/index.md)`<E>` |
| [subscribeAlways](../../net.mamoe.mirai.event/subscribe-always.md) | 在 [Bot](../-bot/index.md) 的 [CoroutineScope](#) 下订阅所有 [E](../../net.mamoe.mirai.event/subscribe-always.md#E) 及其子类事件. 每当 [事件广播](../../net.mamoe.mirai.event/broadcast.md) 时, [listener](../../net.mamoe.mirai.event/subscribe-always.md#net.mamoe.mirai.event$subscribeAlways(net.mamoe.mirai.Bot, kotlin.coroutines.CoroutineContext, net.mamoe.mirai.event.Listener.ConcurrencyKind, kotlin.coroutines.SuspendFunction2((net.mamoe.mirai.event.subscribeAlways.E, , kotlin.Unit)))/listener) 都会被执行.`fun <E : `[`BotEvent`](../../net.mamoe.mirai.event.events/-bot-event/index.md)`> `[`Bot`](../-bot/index.md)`.subscribeAlways(coroutineContext: `[`CoroutineContext`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.coroutines/-coroutine-context/index.html)` = EmptyCoroutineContext, concurrency: ConcurrencyKind = Listener.ConcurrencyKind.CONCURRENT, listener: suspend E.(E) -> `[`Unit`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-unit/index.html)`): `[`Listener`](../../net.mamoe.mirai.event/-listener/index.md)`<E>``fun <E : `[`BotEvent`](../../net.mamoe.mirai.event.events/-bot-event/index.md)`> `[`Bot`](../-bot/index.md)`.subscribeAlways(eventClass: `[`KClass`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.reflect/-k-class/index.html)`<E>, coroutineContext: `[`CoroutineContext`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.coroutines/-coroutine-context/index.html)` = EmptyCoroutineContext, concurrency: ConcurrencyKind = Listener.ConcurrencyKind.CONCURRENT, listener: suspend E.(E) -> `[`Unit`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-unit/index.html)`): `[`Listener`](../../net.mamoe.mirai.event/-listener/index.md)`<E>` |
| [subscribeFriendMessages](../../net.mamoe.mirai.event/subscribe-friend-messages.md) | 订阅来自这个 [Bot](../-bot/index.md) 的所有好友消息事件.`fun <R> `[`Bot`](../-bot/index.md)`.subscribeFriendMessages(coroutineContext: `[`CoroutineContext`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.coroutines/-coroutine-context/index.html)` = EmptyCoroutineContext, concurrencyKind: ConcurrencyKind = Listener.ConcurrencyKind.CONCURRENT, listeners: `[`FriendMessageSubscribersBuilder`](../../net.mamoe.mirai.event/-friend-message-subscribers-builder.md)`.() -> R): R` |
| [subscribeGroupMessages](../../net.mamoe.mirai.event/subscribe-group-messages.md) | 订阅来自这个 [Bot](../-bot/index.md) 的所有群消息事件`fun <R> `[`Bot`](../-bot/index.md)`.subscribeGroupMessages(coroutineContext: `[`CoroutineContext`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.coroutines/-coroutine-context/index.html)` = EmptyCoroutineContext, concurrencyKind: ConcurrencyKind = Listener.ConcurrencyKind.CONCURRENT, listeners: `[`GroupMessageSubscribersBuilder`](../../net.mamoe.mirai.event/-group-message-subscribers-builder.md)`.() -> R): R` |
| [subscribeMessages](../../net.mamoe.mirai.event/subscribe-messages.md) | 订阅来自这个 [Bot](../-bot/index.md) 的所有联系人的消息事件. 联系人可以是任意群或任意好友或临时会话.`fun <R> `[`Bot`](../-bot/index.md)`.subscribeMessages(coroutineContext: `[`CoroutineContext`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.coroutines/-coroutine-context/index.html)` = EmptyCoroutineContext, concurrencyKind: ConcurrencyKind = Listener.ConcurrencyKind.CONCURRENT, listeners: `[`MessagePacketSubscribersBuilder`](../../net.mamoe.mirai.event/-message-packet-subscribers-builder.md)`.() -> R): R` |
| [subscribeOnce](../../net.mamoe.mirai.event/subscribe-once.md) | 在 [Bot](../-bot/index.md) 的 [CoroutineScope](#) 下订阅所有 [E](../../net.mamoe.mirai.event/subscribe-once.md#E) 及其子类事件. 仅在第一次 [事件广播](../../net.mamoe.mirai.event/broadcast.md) 时, [listener](../../net.mamoe.mirai.event/subscribe-once.md#net.mamoe.mirai.event$subscribeOnce(net.mamoe.mirai.Bot, kotlin.coroutines.CoroutineContext, kotlin.coroutines.SuspendFunction2((net.mamoe.mirai.event.subscribeOnce.E, , kotlin.Unit)))/listener) 会被执行.`fun <E : `[`BotEvent`](../../net.mamoe.mirai.event.events/-bot-event/index.md)`> `[`Bot`](../-bot/index.md)`.subscribeOnce(coroutineContext: `[`CoroutineContext`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.coroutines/-coroutine-context/index.html)` = EmptyCoroutineContext, listener: suspend E.(E) -> `[`Unit`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-unit/index.html)`): `[`Listener`](../../net.mamoe.mirai.event/-listener/index.md)`<E>``fun <E : `[`BotEvent`](../../net.mamoe.mirai.event.events/-bot-event/index.md)`> `[`Bot`](../-bot/index.md)`.subscribeOnce(eventClass: `[`KClass`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.reflect/-k-class/index.html)`<E>, coroutineContext: `[`CoroutineContext`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.coroutines/-coroutine-context/index.html)` = EmptyCoroutineContext, listener: suspend E.(E) -> `[`Unit`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-unit/index.html)`): `[`Listener`](../../net.mamoe.mirai.event/-listener/index.md)`<E>` |
| [subscribeTempMessages](../../net.mamoe.mirai.event/subscribe-temp-messages.md) | 订阅来自这个 [Bot](../-bot/index.md) 的所有临时会话消息事件.`fun <R> `[`Bot`](../-bot/index.md)`.subscribeTempMessages(coroutineContext: `[`CoroutineContext`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.coroutines/-coroutine-context/index.html)` = EmptyCoroutineContext, concurrencyKind: ConcurrencyKind = Listener.ConcurrencyKind.CONCURRENT, listeners: `[`TempMessageSubscribersBuilder`](../../net.mamoe.mirai.event/-temp-message-subscribers-builder.md)`.() -> R): R` |

