[mirai-core](../index.md) / [net.mamoe.mirai.event](./index.md)

## Package net.mamoe.mirai.event

### Types

| [AbstractCancellableEvent](-abstract-cancellable-event/index.md) | 可被取消的事件的实现`abstract class AbstractCancellableEvent : `[`Event`](-event.md)`, `[`CancellableEvent`](-cancellable-event/index.md) |
| [BroadcastControllable](-broadcast-controllable/index.md) | 可控制是否需要广播这个事件包`interface BroadcastControllable : `[`Event`](-event.md) |
| [CancellableEvent](-cancellable-event/index.md) | 可被取消的事件`interface CancellableEvent` |
| [Event](-event.md) | 可被监听的类, 可以是任何 class 或 object.`interface Event` |
| [FriendMessageSubscribersBuilder](-friend-message-subscribers-builder.md) | `typealias FriendMessageSubscribersBuilder = `[`MessageSubscribersBuilder`](-message-subscribers-builder/index.md)`<`[`FriendMessage`](../net.mamoe.mirai.message/-friend-message/index.md)`, `[`Listener`](-listener/index.md)`<`[`FriendMessage`](../net.mamoe.mirai.message/-friend-message/index.md)`>, `[`Unit`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-unit/index.html)`, `[`Unit`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-unit/index.html)`>` |
| [GroupMessageSubscribersBuilder](-group-message-subscribers-builder.md) | `typealias GroupMessageSubscribersBuilder = `[`MessageSubscribersBuilder`](-message-subscribers-builder/index.md)`<`[`GroupMessage`](../net.mamoe.mirai.message/-group-message/index.md)`, `[`Listener`](-listener/index.md)`<`[`GroupMessage`](../net.mamoe.mirai.message/-group-message/index.md)`>, `[`Unit`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-unit/index.html)`, `[`Unit`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-unit/index.html)`>` |
| [Listener](-listener/index.md) | 事件监听器. 由 [subscribe](kotlinx.coroutines.-coroutine-scope/subscribe.md) 等方法返回.`interface Listener<in E : `[`Event`](-event.md)`> : CompletableJob` |
| [ListeningStatus](-listening-status/index.md) | 订阅者的状态`enum class ListeningStatus` |
| [MessageListener](-message-listener.md) | 消息事件的处理器.`typealias MessageListener<T, R> = suspend T.(`[`String`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-string/index.html)`) -> R` |
| [MessagePacketSubscribersBuilder](-message-packet-subscribers-builder.md) | `typealias MessagePacketSubscribersBuilder = `[`MessageSubscribersBuilder`](-message-subscribers-builder/index.md)`<`[`ContactMessage`](../net.mamoe.mirai.message/-contact-message/index.md)`, `[`Listener`](-listener/index.md)`<`[`ContactMessage`](../net.mamoe.mirai.message/-contact-message/index.md)`>, `[`Unit`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-unit/index.html)`, `[`Unit`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-unit/index.html)`>` |
| [MessageSelectBuilder](-message-select-builder/index.md) | [selectMessages](select-messages.md) 时的 DSL 构建器.`abstract class MessageSelectBuilder<M : `[`ContactMessage`](../net.mamoe.mirai.message/-contact-message/index.md)`, R> : `[`MessageSelectBuilderUnit`](-message-select-builder-unit/index.md)`<M, R>` |
| [MessageSelectBuilderUnit](-message-select-builder-unit/index.md) | [selectMessagesUnit](select-messages-unit.md) 或 [selectMessages](select-messages.md) 时的 DSL 构建器.`abstract class MessageSelectBuilderUnit<M : `[`ContactMessage`](../net.mamoe.mirai.message/-contact-message/index.md)`, R> : `[`MessageSubscribersBuilder`](-message-subscribers-builder/index.md)`<M, `[`Unit`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-unit/index.html)`, R, `[`Any`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-any/index.html)`?>` |
| [MessageSelectionTimeoutChecker](-message-selection-timeout-checker/index.md) | `class MessageSelectionTimeoutChecker` |
| [MessageSubscribersBuilder](-message-subscribers-builder/index.md) | 消息订阅构造器`open class MessageSubscribersBuilder<M : `[`ContactMessage`](../net.mamoe.mirai.message/-contact-message/index.md)`, out Ret, R : RR, RR>` |
| [TempMessageSubscribersBuilder](-temp-message-subscribers-builder.md) | `typealias TempMessageSubscribersBuilder = `[`MessageSubscribersBuilder`](-message-subscribers-builder/index.md)`<`[`TempMessage`](../net.mamoe.mirai.message/-temp-message/index.md)`, `[`Listener`](-listener/index.md)`<`[`TempMessage`](../net.mamoe.mirai.message/-temp-message/index.md)`>, `[`Unit`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-unit/index.html)`, `[`Unit`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-unit/index.html)`>` |

### Annotations

| [MessageDsl](-message-dsl/index.md) | DSL 标记. 将能让 IDE 阻止一些错误的方法调用.`annotation class MessageDsl` |

### Exceptions

| [MessageSelectionTimeoutException](-message-selection-timeout-exception/index.md) | `class MessageSelectionTimeoutException : `[`RuntimeException`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-runtime-exception/index.html) |

### Extensions for External Classes

| [kotlinx.coroutines.CoroutineScope](kotlinx.coroutines.-coroutine-scope/index.md) |  |

### Properties

| [EventDisabled](-event-disabled.md) | 设置为 `true` 以关闭事件. 所有的 `subscribe` 都能正常添加到监听器列表, 但所有的广播都会直接返回.`var EventDisabled: `[`Boolean`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-boolean/index.html) |

### Functions

| [broadcast](broadcast.md) | 广播一个事件的唯一途径.`suspend fun <E : `[`Event`](-event.md)`> E.broadcast(): E` |
| [incoming](incoming.md) | 打开一个来自指定 [Bot](../net.mamoe.mirai/-bot/index.md) 的指定事件的接收通道`fun <E : `[`BotEvent`](../net.mamoe.mirai.event.events/-bot-event/index.md)`> `[`Bot`](../net.mamoe.mirai/-bot/index.md)`.incoming(coroutineContext: `[`CoroutineContext`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.coroutines/-coroutine-context/index.html)` = EmptyCoroutineContext, concurrencyKind: ConcurrencyKind = Listener.ConcurrencyKind.CONCURRENT, capacity: `[`Int`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-int/index.html)` = Channel.UNLIMITED): ReceiveChannel<E>` |
| [selectMessages](select-messages.md) | 挂起当前协程, 等待任意一个事件监听器触发后返回其返回值.`suspend fun <T : `[`ContactMessage`](../net.mamoe.mirai.message/-contact-message/index.md)`, R> T.selectMessages(timeoutMillis: `[`Long`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-long/index.html)` = -1, filterContext: `[`Boolean`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-boolean/index.html)` = true, selectBuilder: `[`MessageSelectBuilder`](-message-select-builder/index.md)`<T, R>.() -> `[`Unit`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-unit/index.html)`): R` |
| [selectMessagesUnit](select-messages-unit.md) | [selectMessages](select-messages.md) 的 [Unit](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-unit/index.html) 返回值捷径 (由于 Kotlin 无法推断 [Unit](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-unit/index.html) 类型)`suspend fun <T : `[`ContactMessage`](../net.mamoe.mirai.message/-contact-message/index.md)`> T.selectMessagesUnit(timeoutMillis: `[`Long`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-long/index.html)` = -1, filterContext: `[`Boolean`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-boolean/index.html)` = true, selectBuilder: `[`MessageSelectBuilderUnit`](-message-select-builder-unit/index.md)`<T, `[`Unit`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-unit/index.html)`>.() -> `[`Unit`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-unit/index.html)`): `[`Unit`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-unit/index.html) |
| [subscribe](subscribe.md) | 在 [Bot](../net.mamoe.mirai/-bot/index.md) 的 [CoroutineScope](#) 下订阅所有 [E](subscribe.md#E) 及其子类事件. 每当 [事件广播](broadcast.md) 时, [handler](subscribe.md#net.mamoe.mirai.event$subscribe(net.mamoe.mirai.Bot, kotlin.coroutines.CoroutineContext, net.mamoe.mirai.event.Listener.ConcurrencyKind, kotlin.coroutines.SuspendFunction2((net.mamoe.mirai.event.subscribe.E, , net.mamoe.mirai.event.ListeningStatus)))/handler) 都会被执行, 当 [handler](subscribe.md#net.mamoe.mirai.event$subscribe(net.mamoe.mirai.Bot, kotlin.coroutines.CoroutineContext, net.mamoe.mirai.event.Listener.ConcurrencyKind, kotlin.coroutines.SuspendFunction2((net.mamoe.mirai.event.subscribe.E, , net.mamoe.mirai.event.ListeningStatus)))/handler) 返回 [ListeningStatus.STOPPED](-listening-status/-s-t-o-p-p-e-d.md) 时停止监听`fun <E : `[`BotEvent`](../net.mamoe.mirai.event.events/-bot-event/index.md)`> `[`Bot`](../net.mamoe.mirai/-bot/index.md)`.subscribe(coroutineContext: `[`CoroutineContext`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.coroutines/-coroutine-context/index.html)` = EmptyCoroutineContext, concurrency: ConcurrencyKind = Listener.ConcurrencyKind.LOCKED, handler: suspend E.(E) -> `[`ListeningStatus`](-listening-status/index.md)`): `[`Listener`](-listener/index.md)`<E>``fun <E : `[`BotEvent`](../net.mamoe.mirai.event.events/-bot-event/index.md)`> `[`Bot`](../net.mamoe.mirai/-bot/index.md)`.subscribe(eventClass: `[`KClass`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.reflect/-k-class/index.html)`<E>, coroutineContext: `[`CoroutineContext`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.coroutines/-coroutine-context/index.html)` = EmptyCoroutineContext, concurrency: ConcurrencyKind = Listener.ConcurrencyKind.LOCKED, handler: suspend E.(E) -> `[`ListeningStatus`](-listening-status/index.md)`): `[`Listener`](-listener/index.md)`<E>` |
| [subscribeAlways](subscribe-always.md) | 在 [Bot](../net.mamoe.mirai/-bot/index.md) 的 [CoroutineScope](#) 下订阅所有 [E](subscribe-always.md#E) 及其子类事件. 每当 [事件广播](broadcast.md) 时, [listener](subscribe-always.md#net.mamoe.mirai.event$subscribeAlways(net.mamoe.mirai.Bot, kotlin.coroutines.CoroutineContext, net.mamoe.mirai.event.Listener.ConcurrencyKind, kotlin.coroutines.SuspendFunction2((net.mamoe.mirai.event.subscribeAlways.E, , kotlin.Unit)))/listener) 都会被执行.`fun <E : `[`BotEvent`](../net.mamoe.mirai.event.events/-bot-event/index.md)`> `[`Bot`](../net.mamoe.mirai/-bot/index.md)`.subscribeAlways(coroutineContext: `[`CoroutineContext`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.coroutines/-coroutine-context/index.html)` = EmptyCoroutineContext, concurrency: ConcurrencyKind = Listener.ConcurrencyKind.CONCURRENT, listener: suspend E.(E) -> `[`Unit`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-unit/index.html)`): `[`Listener`](-listener/index.md)`<E>``fun <E : `[`BotEvent`](../net.mamoe.mirai.event.events/-bot-event/index.md)`> `[`Bot`](../net.mamoe.mirai/-bot/index.md)`.subscribeAlways(eventClass: `[`KClass`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.reflect/-k-class/index.html)`<E>, coroutineContext: `[`CoroutineContext`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.coroutines/-coroutine-context/index.html)` = EmptyCoroutineContext, concurrency: ConcurrencyKind = Listener.ConcurrencyKind.CONCURRENT, listener: suspend E.(E) -> `[`Unit`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-unit/index.html)`): `[`Listener`](-listener/index.md)`<E>` |
| [subscribeFriendMessages](subscribe-friend-messages.md) | 订阅来自这个 [Bot](../net.mamoe.mirai/-bot/index.md) 的所有好友消息事件.`fun <R> `[`Bot`](../net.mamoe.mirai/-bot/index.md)`.subscribeFriendMessages(coroutineContext: `[`CoroutineContext`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.coroutines/-coroutine-context/index.html)` = EmptyCoroutineContext, concurrencyKind: ConcurrencyKind = Listener.ConcurrencyKind.CONCURRENT, listeners: `[`FriendMessageSubscribersBuilder`](-friend-message-subscribers-builder.md)`.() -> R): R` |
| [subscribeGroupMessages](subscribe-group-messages.md) | 订阅来自这个 [Bot](../net.mamoe.mirai/-bot/index.md) 的所有群消息事件`fun <R> `[`Bot`](../net.mamoe.mirai/-bot/index.md)`.subscribeGroupMessages(coroutineContext: `[`CoroutineContext`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.coroutines/-coroutine-context/index.html)` = EmptyCoroutineContext, concurrencyKind: ConcurrencyKind = Listener.ConcurrencyKind.CONCURRENT, listeners: `[`GroupMessageSubscribersBuilder`](-group-message-subscribers-builder.md)`.() -> R): R` |
| [subscribeMessages](subscribe-messages.md) | 订阅来自这个 [Bot](../net.mamoe.mirai/-bot/index.md) 的所有联系人的消息事件. 联系人可以是任意群或任意好友或临时会话.`fun <R> `[`Bot`](../net.mamoe.mirai/-bot/index.md)`.subscribeMessages(coroutineContext: `[`CoroutineContext`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.coroutines/-coroutine-context/index.html)` = EmptyCoroutineContext, concurrencyKind: ConcurrencyKind = Listener.ConcurrencyKind.CONCURRENT, listeners: `[`MessagePacketSubscribersBuilder`](-message-packet-subscribers-builder.md)`.() -> R): R` |
| [subscribeOnce](subscribe-once.md) | 在 [Bot](../net.mamoe.mirai/-bot/index.md) 的 [CoroutineScope](#) 下订阅所有 [E](subscribe-once.md#E) 及其子类事件. 仅在第一次 [事件广播](broadcast.md) 时, [listener](subscribe-once.md#net.mamoe.mirai.event$subscribeOnce(net.mamoe.mirai.Bot, kotlin.coroutines.CoroutineContext, kotlin.coroutines.SuspendFunction2((net.mamoe.mirai.event.subscribeOnce.E, , kotlin.Unit)))/listener) 会被执行.`fun <E : `[`BotEvent`](../net.mamoe.mirai.event.events/-bot-event/index.md)`> `[`Bot`](../net.mamoe.mirai/-bot/index.md)`.subscribeOnce(coroutineContext: `[`CoroutineContext`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.coroutines/-coroutine-context/index.html)` = EmptyCoroutineContext, listener: suspend E.(E) -> `[`Unit`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-unit/index.html)`): `[`Listener`](-listener/index.md)`<E>``fun <E : `[`BotEvent`](../net.mamoe.mirai.event.events/-bot-event/index.md)`> `[`Bot`](../net.mamoe.mirai/-bot/index.md)`.subscribeOnce(eventClass: `[`KClass`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.reflect/-k-class/index.html)`<E>, coroutineContext: `[`CoroutineContext`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.coroutines/-coroutine-context/index.html)` = EmptyCoroutineContext, listener: suspend E.(E) -> `[`Unit`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-unit/index.html)`): `[`Listener`](-listener/index.md)`<E>` |
| [subscribeTempMessages](subscribe-temp-messages.md) | 订阅来自这个 [Bot](../net.mamoe.mirai/-bot/index.md) 的所有临时会话消息事件.`fun <R> `[`Bot`](../net.mamoe.mirai/-bot/index.md)`.subscribeTempMessages(coroutineContext: `[`CoroutineContext`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.coroutines/-coroutine-context/index.html)` = EmptyCoroutineContext, concurrencyKind: ConcurrencyKind = Listener.ConcurrencyKind.CONCURRENT, listeners: `[`TempMessageSubscribersBuilder`](-temp-message-subscribers-builder.md)`.() -> R): R` |
| [syncFromEvent](sync-from-event.md) | 挂起当前协程, 监听事件 [E](sync-from-event.md#E), 并尝试从这个事件中**同步**一个值, 在超时时抛出 [TimeoutCancellationException](#)`suspend fun <E : `[`Event`](-event.md)`, R : `[`Any`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-any/index.html)`> syncFromEvent(timeoutMillis: `[`Long`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-long/index.html)` = -1, mapper: suspend E.(E) -> R?): R` |
| [syncFromEventOrNull](sync-from-event-or-null.md) | 挂起当前协程, 监听这个事件, 并尝试从这个事件中获取一个值, 在超时时返回 `null``suspend fun <E : `[`Event`](-event.md)`, R : `[`Any`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-any/index.html)`> syncFromEventOrNull(timeoutMillis: `[`Long`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-long/index.html)`, mapper: suspend E.(E) -> R?): R?` |
| [whileSelectMessages](while-select-messages.md) | 挂起当前协程, 等待任意一个事件监听器返回 `false` 后返回.`suspend fun <T : `[`ContactMessage`](../net.mamoe.mirai.message/-contact-message/index.md)`> T.whileSelectMessages(timeoutMillis: `[`Long`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-long/index.html)` = -1, filterContext: `[`Boolean`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-boolean/index.html)` = true, selectBuilder: `[`MessageSelectBuilder`](-message-select-builder/index.md)`<T, `[`Boolean`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-boolean/index.html)`>.() -> `[`Unit`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-unit/index.html)`): `[`Unit`](https://kotlinlang.org/api/latest/jvm/stdlib/kotlin/-unit/index.html) |

